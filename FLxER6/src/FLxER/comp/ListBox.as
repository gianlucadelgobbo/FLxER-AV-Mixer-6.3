package FLxER.comp{	import flash.display.Sprite;	import flash.utils.clearInterval;	import flash.utils.setInterval;	import flash.xml.XMLNode;		import FLxER.comp.ButtonArrow;	import FLxER.main.Rett;	public class ListBox extends Sprite {		private var myXml:XMLNode;		private var fnz:Function;		private var n:uint;		////		private var c:uint;		private var conta:Number;		private var labs:Sprite;		public var labsA:Object;		private var up:ButtonArrow;		private var down:ButtonArrow;		private var firsTime:Boolean;		private var scrollF:Rett;		public function ListBox(xx:Number,yy:Number,ww:uint,hh:uint,f:Function, xml:XMLNode, nn:uint, altUp:String, altDown:String):void {			x = xx;			y = yy;			n = nn;			fnz = f;			//labs = new Object();			scrollF = new Rett(0, 0, ww, (hh*n), 0x999999, -1, 1)			this.addChild(scrollF);			labsA = new Object();			labs = new Sprite();			var fPos:Object;			if (n == 1) {				fPos = {xUp:ww-24,xDown:ww-13,yUp:2,yDown:(hh*n)-7}				labsA.lab0 = new ButtonTxt(0, 0, ww-28, hh, " ", seleziona, "0", null);				this.labs.addChild(labsA.lab0);			} else {				fPos = {xUp:ww-11,xDown:ww-11,yUp:1,yDown:(hh*n)-6}				for (var b:int=0; b<n; b++) {					labsA["lab"+b] = new ButtonTxt(0, b*hh, ww-13, hh, " ", seleziona, b.toString(), null);					this.labs.addChild(labsA["lab"+b]);				}			}			this.up = new ButtonArrow(fPos.xUp, fPos.yUp, 180, avvia_scrolla, -1, altUp);			this.down = new ButtonArrow(fPos.xDown, fPos.yDown, 0, avvia_scrolla, 1, altDown);			this.addChild(down);			this.addChild(up);			if (xml) {				avvia(xml);			}			this.addChild(labs);		}		public function avvia(xml:XMLNode):void {			firsTime = true;			conta = 0;			myXml = xml;			riempi();		}		public function resetta():void {			if (myXml) {				firsTime = true;				conta = 0;				riempi();			}		}		private function riempi():void {			for (var d:int=0; d<n; d++) {				if (d+conta<myXml.childNodes.length) {					//trace("riempi   "+myXml.childNodes[d+conta].attributes.m);					labsA["lab"+d].lab.text = myXml.childNodes[d+conta].attributes.m;				} else {					labsA["lab"+d].lab.text = " ";				}			}		}		public function svuota():void {			conta = 0;			for (var d:int=0; d<n; d++) {				labsA["lab"+d].lab.text = " ";			}		}		private function avvia_scrolla(b:Number):void {			if (b) {				c = setInterval(scrolla, 100, b);				scrolla(b);			} else {				clearInterval(c);			}		}		public function scrolla(b:Number):void {			if (conta+b>=0) {				if (b+conta<myXml.childNodes.length) {					conta += (firsTime ? 0 : b);					firsTime = false					riempi();				} else {					clearInterval(c);				}			}		}		public function myEnable():void {			for (var b:int=0; b<n; b++) {				labsA["lab"+b].myEnable();			}			this.up.myEnable();			this.down.myEnable();		}		public function myDisable():void {			for (var b:int=0; b<n; b++) {				labsA["lab"+b].myDisable();			}			this.up.myDisable();			this.down.myDisable();		}		public function seleziona(b:Number):void {			firsTime = false			if (myXml.childNodes[conta+b].attributes.val != undefined) {				fnz(myXml.childNodes[conta+b].attributes.m, myXml.childNodes[conta+b].attributes.val);			} else if (myXml.childNodes[conta+b].attributes.m != undefined) {				fnz(myXml.childNodes[conta+b].attributes.m,myXml.childNodes[conta+b].attributes.m);			}		}	}}